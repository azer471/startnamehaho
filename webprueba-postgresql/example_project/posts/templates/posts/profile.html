{% extends 'posts/base.html' %}
{% block content %}

{% load staticfiles %}

  {% block head %}
      <link rel="stylesheet" href="{% static 'css/article_form.css' %}">
      <link rel="stylesheet" href="{% static 'css/tab.css' %}">

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>jQuery Tabs Responsive Tabs Plugin Demo</title>
		<link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.4.0/animate.css">
        <link href="http://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">

  {% endblock %}


<div class="context">
<div class="avatar">
<img class="img-responsive" src="{{ user.profile.image_url}}" />
<div class="avatar-user">
<h1>{{ user }}</h1>
</div>
</div>	
		<div class="wrapper">
			<div class="tabs-wrapper">
				<ul class="tab-nav">
{% if user == request.user%}	
					<li>
						<a href="#" data-target="tab-1"class="list-group-item" href="#"><i class="fa fa-cog fa-fw" aria-hidden="true"></i>&nbsp; Settings</a></a>
					</li>
{% endif%}
					<li class="active">
						<a href="#" data-target="tab-2">معلومات عن المشارك </a>
					</li>
					<li>
						<a href="#" data-target="tab-3">أخبار المرسلة </a>
					</li>
					<li>
						<a href="#" data-target="tab-4">التعليقات</a>
					</li>
				</ul>
				<div class="target-tabs">



{% if user == request.user%}				
					<div id="tab-1" class="tab-content">


<ul><li><h2>تغيير الصورة</h2></li></ul>
<div class="zone-avatar" dir=ltr>
  <form method="post" enctype="multipart/form-data" onsubmit="return Validate(this);">

    {% csrf_token %}
 
    {{ update_profile_form.as_p }}

    <button type="submit">Upload</button>
  </form>
</div>


<ul><li><h2>تغيير كلمة السر</h2></li></ul>
<div class="zone-password" dir=ltr>
<form method="post">
  {% csrf_token %}
 
  {{ form_passw }}

  <button type="submit">Save changes</button>
  {% if messages %}

    {% for message in messages %}
    <h3 dir="rtl" {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</h3>
    {% endfor %}

   {% endif %}

</form>

</div>




					</div>

{% endif%}






					<div id="tab-2" class="tab-content">



    <ul>
      		<li><a>اسم المستخدم: {{ user.get_username  }}</a></li>
      		<li><a>تاريخ التسجيل:  {{user.date_joined}}</a></li>
      		<li><a>آخر نشاط للحساب:  {{user.last_login}}</a></li>



{% if posts_count > 0 %}  		    		  		
      		<li> <a dir=ltr>معدل الاصوات: %{{posts_count_votes|floatformat:"2" }}</a></li>  
 {% endif %}    
  		         	
    </ul>








					</div>
					<div id="tab-3" class="tab-content">

							<div id="right">
								{% for article in  posts%}

								<div class="article">

									<div class="vote_wrapper" id="{{ article.id }}">
									<li data-position="{{ article.votes }}"></li>

									<div class="arrow up" id="plus"></div>
									<div class="score">{{ article.votes }}</div>
									<div class="arrow down" id="minus"></div>
									</div>


									<div class="row">

										<div class="post">
										<div class="link">
										<h2>
										<a href="{{article.url}}">{{ article.title }}</a>
										</h2>
										</div>

										<div class="submited">
										<span class="step-author">    من طرف:{{ article.author }}</span>	
										{% if article.news_website %}		
										<span class="step-website"> موقع:{{ article.news_website }}</span>
										{% endif %}
										{% if article.pageweb %}
										<span class="step-wwebsite"> موقع:{{ article.pageweb }}</span>
										{% endif %}
										<span class="step-date">{{ article.created_date }}</span>		
										</div> 
										<div class="description">
										<p>{{ article.description }}</p>
										</div> 
										<!-- AddToAny BEGIN -->


										<!-- AddToAny END -->
										</div>


									<!--  separador               -->

										<div class="news-details">
										<div class="news-details-main">
										<div class="news-details-data-down">
										<a href="/{{ article.id }}/"   title="من اجل التعليق عن الخبر!" class="myButton">تعليقات </a> 

										<a href="#" title="ابلاغ عن خبر غير صحيح!" class="myButton1">الإبلاغ</a> 
										</div>
										</div>
										</div>
									<!--  separador               -->
									</div>


								</div>			

								{% endfor %}	

							</div>

						<div class="pagination">
							<div id="inner">

							    <span class="step-links">
							    {% if blogs.has_previous %}
							        <a href="?page={{blogs.previous_page_number}}{% if request.GET.q%}&q{{ request.GET.q }}{% endif%}">  <span class="prev">   &laquo; </span>  </a>
							    {% endif %}


							    {% for pg in page_range %}
							        {% if blogs.number == pg %}

							       
							          <a href="?page={{pg}}" > <span class="current"> {{pg}}</span></a>
							     
							  


							        {% else %}
							          <a href="?page={{pg}}">{{pg}}</a>
							        {% endif %}
							    {% endfor %}

							    {% if blogs.has_next %}
							        <a href="?page={{blogs.next_page_number}}{% if request.GET.q%}&q{{ request.GET.q }}{% endif%}">  <span class="prev">   &raquo; </span>    </a>
							    {% endif %}	 

							    </span>
							</div>
						</div>

					</div>
					<div id="tab-4" class="tab-content">
				




						{% for comment in comments %}



	<div id="container">

		<div class="dialogbox-p">

			<div class="box_wrapper" id="{{ comment.id }}">

				<div class="flecha up" id="plus"></div>
				<div class="score" dir=ltr>{{ comment.votes_comment }}</div>
				<div class="flecha down" id="minus"></div>

			</div>

			<div class="zone-image">
				<div class="image-avatar">
				<img class="video-thumb comment-author-thumbnail yt-thumb yt-thumb-48" src="{{ comment.author.profile.image_url}}" />
				</div>
			</div>

			<div class="body-p">
				<div class="comment-header">
					من طرف: <a href="{% url 'posts:user_profile' comment.author %}">{{ comment.author }} </a>

					<span class="timesince"> {{ comment.timestamp }} </span>
				</div>
				<div class="message-p">
					<span>{{ comment.content }}</span>

				</div>

			</div>
			<div class="comment-title">
				
				{% if comment.children.count > 0 %}عدد الإجابات:{{ comment.children.count }} 
				{% if comment.children.count > 1 %}{% endif %} | {% endif %} 
				<a class='fa fa-link' href="{{ comment.get_absolute_url }}"></a>


			</div>


		</div>     


	{%  for child_comment in comment.children %}



	<div class="dialogbox">
		<div class="box_wrapper" id="{{ child_comment.id }}" >


			<div class="flecha up" id="plus"></div>
			<div class="score" dir=ltr>{{ child_comment.votes_comment }}</div>
			<div class="flecha down" id="minus"></div>

		</div>


		<div class="zone-image-2">
			<div class="image-avatar">
			<img class="video-thumb comment-author-thumbnail yt-thumb yt-thumb-47" src="{{ child_comment.author.profile.image_url}}" />
			</div>
		</div>




		<div class="body">
			<span class="tip tip-up"></span>
			<div class="comment-header">

			من طرف:  <a href="{% url 'posts:user_profile' child_comment.author %}">{{ child_comment.author }} </a>

			<span class="timesince"> {{ comment.timestamp }} </span>
			</div>
				<div class="message">


			<span>  {{ child_comment.content }}</span>					
			</div>
		</div>
	</div>




	{% endfor %}
	</div>



						{% endfor%}



















					</div>
				</div>
			</div>
		</div>
		</div>
		<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
		<script src="{% static "js/tabs.js" %}" type="text/javascript"></script>
		<script>
			$('.tabs-wrapper').tabs();
		</script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36251023-1']);
  _gaq.push(['_setDomainName', 'jqueryscript.net']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();








var uploadField = document.getElementById("id_avatar");

uploadField.onchange = function() {
    if(this.files[0].size > 102400){
       alert("File is too big!");
       this.value = "";
    }





    var fileExtension = "";
    if (uploadField.value.lastIndexOf(".") > 0) {
        fileExtension = uploadField.value.substring(uploadField.value.lastIndexOf(".") + 1, uploadField.value.length);
    }
    if (fileExtension.toLowerCase() == "jpeg" || FileExtension.toLowerCase() == "png" || FileExtension.toLowerCase() == "jpg") {
        return true;
    }
    else {
        alert("You must select a 'JPEG' 'JPG' or 'PNG'  file for upload");
        this.value = "";
        return false;
    }




};


var _validFileExtensions = [".jpg", ".jpeg", ".bmp", ".gif", ".png"];    
function Validate(oForm) {
    var arrInputs = oForm.getElementsByTagName("input");
    for (var i = 0; i < arrInputs.length; i++) {
        var oInput = arrInputs[i];
        if (oInput.type == "file") {
            var sFileName = oInput.value;
            if (sFileName.length > 0) {
                var blnValid = false;
                for (var j = 0; j < _validFileExtensions.length; j++) {
                    var sCurExtension = _validFileExtensions[j];
                    if (sFileName.substr(sFileName.length - sCurExtension.length, sCurExtension.length).toLowerCase() == sCurExtension.toLowerCase()) {
                        blnValid = true;
                        break;
                    }
                }
                
                if (!blnValid) {
                    alert("Sorry, " + sFileName + " is invalid, allowed extensions are: " + _validFileExtensions.join(", "));
                    return false;
                }
            }
        }
    }
  
    return true;
}

</script>








  {% endblock content %}